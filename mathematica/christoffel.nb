(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     55080,       1595]
NotebookOptionsPosition[     52347,       1504]
NotebookOutlinePosition[     53037,       1527]
CellTagsIndexPosition[     52994,       1524]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Christoffel Symbols and Curvature", "Subtitle",
 CellChangeTimes->{{3.6733490814419885`*^9, 3.6733490931109266`*^9}}],

Cell[TextData[{
 "This is a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " program to compute the Christoffel  and the geodesic equations, starting \
from a given metric  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontSlant->"Italic"], "\[Alpha]\[Beta]"], TraditionalForm]]],
 ". The Christoffel symbols are calculated from the formula"
}], "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Mu]\[Nu]"], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SuperscriptBox["g", "\[Lambda]\[Sigma]"], "(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Mu]"], " ", 
        SubscriptBox["g", "\[Sigma]\[Nu]"]}], "+", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Nu]"], " ", 
        SubscriptBox["g", "\[Sigma]\[Mu]"]}], "-", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Sigma]"], " ", 
        SubscriptBox["g", "\[Mu]\[Nu]"]}]}], ")"}]}]}], TraditionalForm]]],
 "\n\nwhere ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "\[Lambda]\[Sigma]"], TraditionalForm]]],
 " is the matrix inverse of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", 
    RowBox[{"\[Lambda]\[Sigma]", " "}]], TraditionalForm]]],
 "called the inverse metric. This is the  solution of the relation (8.19) and \
the notation for the inverse metric is standard [cf (20.17)]. The components \
of the geodesic equation are \n\n",
 StyleBox["d",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Alpha]"], TraditionalForm]]],
 "/",
 StyleBox["d\[Tau]",
  FontSlant->"Italic"],
 " = - ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Beta]\[Gamma]"], 
   TraditionalForm]]],
 " ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Beta]"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Gamma]"], TraditionalForm]]],
 " ."
}], "Text"],

Cell[TextData[{
 "You must input the covariant components of the metric tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]]],
 " by editing the relevant input line in this ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook. You may also wish to change the names of the coordinates. The \
nonzero components of the above quantities are displayed as the output. "
}], "Text"],

Cell[CellGroupData[{

Cell["Clearing the values of symbols:", "Subsubsection"],

Cell["\<\
First clear any values that may already have been assigned to the names of \
the various objects to be calculated. The names of the coordinates that you \
will use are also cleared.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "coord", ",", " ", "metric", ",", "inversemetric", ",", " ", "affine", ",", 
   "Curvature", ",", "t", ",", " ", "x", ",", " ", "y", ",", " ", "z", ",", 
   "Psi00", ",", "Psi01", ",", "Psi02", ",", "Psi03", ",", "Psi11", ",", 
   "Psi12", ",", "Psi13", ",", "Psi22", ",", "Psi23", ",", "Psi33"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6535374728086004`*^9, 3.6535374756213264`*^9}, {
   3.673341614064495*^9, 3.6733416406675477`*^9}, {3.6733423795943937`*^9, 
   3.6733423843917103`*^9}, {3.71759931389472*^9, 3.7175993168363047`*^9}, {
   3.719144667326086*^9, 3.7191447029673357`*^9}, {3.7191459153351808`*^9, 
   3.7191459170776715`*^9}, {3.719146225925313*^9, 3.7191462421134872`*^9}, 
   3.7529183931402082`*^9, {3.75291853313306*^9, 3.7529185631435432`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting The Dimension :", "Subsubsection",
 CellChangeTimes->{3.673336903421093*^9}],

Cell[TextData[{
 "The dimension ",
 StyleBox["n",
  FontWeight->"Bold"],
 " of the spacetime (or space) must be set:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "4"}]], "Input"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.7529670099231443`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining a list of coordinates:", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{"coord", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 RowBox[{"R", ":=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"], "+", 
     SuperscriptBox["z", "2"]}], ")"}], "0.5"]}]}], "Input",
 CellChangeTimes->{{3.6535373008047457`*^9, 3.653537309329725*^9}, {
   3.6733341421983705`*^9, 3.673334270496571*^9}, 3.67333461359501*^9, 
   3.6733348187458467`*^9, {3.6733423910525866`*^9, 3.6733423939439526`*^9}, {
   3.717644087336652*^9, 3.717644156203772*^9}, {3.7191443768811646`*^9, 
   3.7191443818924885`*^9}, {3.752918331990469*^9, 3.7529183330939503`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.7529670099478903`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining the metric:", "Subsubsection",
 CellChangeTimes->{{3.6733343840588837`*^9, 3.673334386462412*^9}}],

Cell[TextData[{
 "Input the metric as a list of lists, i.e., as a matrix. You can input the \
components of any metric ",
 Cell[BoxData[
  FormBox["h", TraditionalForm]]],
 "ere, but you must specify them as explicit functions of the coordinates."
}], "Text",
 CellChangeTimes->{{3.717589620949033*^9, 3.71758962386301*^9}, {
  3.7529183213083763`*^9, 3.752918321853297*^9}, {3.752918456399261*^9, 
  3.7529184677714577`*^9}, {3.752918703980751*^9, 3.752918706244459*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Psi00", ":=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1.0", "-", 
        RowBox[{"M", "/", "R"}]}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"1.0", "+", 
       RowBox[{"M", "/", "R"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Psi01", ":=", "0"}], "\n", 
   RowBox[{"Psi02", ":=", "0"}], "\[IndentingNewLine]", 
   RowBox[{"Psi03", ":=", "0"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Psi11", ":=", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"1.0", "+", 
        RowBox[{"M", "/", "R"}]}], ",", "2.0"}], "]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0", "+", 
         RowBox[{"M", "/", "R"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"M", "/", "R"}]}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"M", ",", "2.0"}], "]"}], "/", 
       RowBox[{"Power", "[", 
        RowBox[{"R", ",", "4.0"}], "]"}]}], "*", 
      RowBox[{"Power", "[", 
       RowBox[{"x", ",", "2.0"}], "]"}]}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"Psi12", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.0", "+", 
        RowBox[{"M", "/", "R"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"M", "/", "R"}]}], ")"}]}], "*", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"M", ",", "2.0"}], "]"}], "/", 
      RowBox[{"Power", "[", 
       RowBox[{"R", ",", "4.0"}], "]"}]}], "*", "x", "*", "y"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"Psi13", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.0", "+", 
        RowBox[{"M", "/", "R"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"M", "/", "R"}]}], ")"}]}], "*", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"M", ",", "2.0"}], "]"}], "/", 
      RowBox[{"Power", "[", 
       RowBox[{"R", ",", "4.0"}], "]"}]}], "*", "x", "*", "z"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"Psi22", ":=", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"1.0", "+", 
        RowBox[{"M", "/", "R"}]}], ",", "2.0"}], "]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0", "+", 
         RowBox[{"M", "/", "R"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"M", "/", "R"}]}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"M", ",", "2.0"}], "]"}], "/", 
       RowBox[{"Power", "[", 
        RowBox[{"R", ",", "4.0"}], "]"}]}], "*", 
      RowBox[{"Power", "[", 
       RowBox[{"y", ",", "2.0"}], "]"}]}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"Psi23", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.0", "+", 
        RowBox[{"M", "/", "R"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"M", "/", "R"}]}], ")"}]}], "*", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"M", ",", "2.0"}], "]"}], "/", 
      RowBox[{"Power", "[", 
       RowBox[{"R", ",", "4.0"}], "]"}]}], "*", "y", "*", "z"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"Psi33", ":=", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"1.0", "+", 
        RowBox[{"M", "/", "R"}]}], ",", "2.0"}], "]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0", "+", 
         RowBox[{"M", "/", "R"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"M", "/", "R"}]}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"M", ",", "2.0"}], "]"}], "/", 
       RowBox[{"Power", "[", 
        RowBox[{"R", ",", "4.0"}], "]"}]}], "*", 
      RowBox[{"Power", "[", 
       RowBox[{"z", ",", "2.0"}], "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.75291870913278*^9, 3.7529187108545237`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metric", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Psi00", ",", "Psi01", ",", "Psi02", ",", "Psi03"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"Psi01", ",", "Psi11", ",", "Psi12", ",", "Psi13"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"Psi02", ",", "Psi12", ",", "Psi22", ",", "Psi23"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"Psi03", ",", "Psi13", ",", "Psi23", ",", "Psi33"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.6535373551856966`*^9, 3.6535374145267754`*^9}, {
   3.653537582186598*^9, 3.6535376162450275`*^9}, {3.673334311509801*^9, 
   3.673334410874631*^9}, {3.673334470005088*^9, 3.673334565312045*^9}, {
   3.673334604661276*^9, 3.673334650783578*^9}, {3.6733346819875765`*^9, 
   3.6733346857146344`*^9}, {3.6733354097191978`*^9, 3.6733354444441156`*^9}, 
   3.6733393815722313`*^9, {3.6733424128811555`*^9, 3.6733424785142255`*^9}, {
   3.7175845228380823`*^9, 3.7175845680135183`*^9}, {3.7175889662912083`*^9, 
   3.71758911452213*^9}, {3.717589165297802*^9, 3.717589200859232*^9}, {
   3.717589417377308*^9, 3.717589420735042*^9}, {3.7175896135447617`*^9, 
   3.71758961378237*^9}, {3.717591624815683*^9, 3.717591666107504*^9}, {
   3.7191221368565993`*^9, 3.7191222865895624`*^9}, {3.7191418053417377`*^9, 
   3.7191418842616987`*^9}, {3.719143927078427*^9, 3.7191440592761354`*^9}, 
   3.752918298352208*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "1.`"}], "+", 
       FractionBox["M", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], 
      RowBox[{"1.`", "\[VeryThinSpace]", "+", 
       FractionBox["M", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}]], ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", 
        SuperscriptBox["x", "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}], "2.`"]}], 
     ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["M", "2.`"], " ", "x", " ", "y", " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["M", "2.`"], " ", "x", " ", "z", " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["M", "2.`"], " ", "x", " ", "y", " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", 
        SuperscriptBox["y", "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}], "2.`"]}], 
     ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["M", "2.`"], " ", "y", " ", "z", " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["M", "2.`"], " ", "x", " ", "z", " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["M", "2.`"], " ", "y", " ", "z", " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", 
        SuperscriptBox["z", "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "+", 
         FractionBox["M", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}], "2.`"]}]}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.752967009991632*^9}]
}, Open  ]],

Cell["You can also display this in matrix form:", "Text",
 CellChangeTimes->{{3.673339394188217*^9, 3.6733393957573786`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metric", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"-", "1.`"}], "+", 
        FractionBox["M", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], 
       RowBox[{"1.`", "\[VeryThinSpace]", "+", 
        FractionBox["M", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}]], "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["M", "2.`"], " ", 
         SuperscriptBox["x", "2.`"], " ", 
         RowBox[{"(", 
          RowBox[{"1.`", "\[VeryThinSpace]", "+", 
           FractionBox["M", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["M", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}], "2.`"]}], 
      
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", "x", " ", "y", " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", "x", " ", "z", " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]]},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", "x", " ", "y", " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["M", "2.`"], " ", 
         SuperscriptBox["y", "2.`"], " ", 
         RowBox[{"(", 
          RowBox[{"1.`", "\[VeryThinSpace]", "+", 
           FractionBox["M", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["M", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}], "2.`"]}], 
      
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", "y", " ", "z", " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]]},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", "x", " ", "z", " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["M", "2.`"], " ", "y", " ", "z", " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["M", "2.`"], " ", 
         SuperscriptBox["z", "2.`"], " ", 
         RowBox[{"(", 
          RowBox[{"1.`", "\[VeryThinSpace]", "+", 
           FractionBox["M", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2.`"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["M", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}]}]], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["M", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "0.5`"]]}], ")"}], "2.`"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7529670100081244`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the inverse metric:", "Subsubsection"],

Cell[BoxData[
 RowBox[{"inversemetric", ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Inverse", "[", "metric", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{3.7529188733174877`*^9}],

Cell["The inverse metric can also be displayed in matrix form:", "Text"],

Cell["inversemetric // MatrixForm", "Item",
 CellChangeTimes->{{3.752919319738327*^9, 3.752919322791428*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the affine connection:", "Subsubsection"],

Cell[BoxData[
 RowBox[{"affine", ":=", 
  RowBox[{"affine", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"inversemetric", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "+", 
            "\[IndentingNewLine]", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], " ", "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displaying the affine connection:", "Subsubsection"],

Cell["\<\
listaffine := Table[If[UnsameQ[affine[[i, j, k]], 0], {ToString[\
\[CapitalGamma][i, j, k]], affine[[i, j, k]]}] , {i, 1, n}, {j, 1, n}, {k, 1, \
j}]\
\>", "Item",
 CellChangeTimes->{{3.6733425468985653`*^9, 3.673342562115239*^9}, {
  3.6733427141474895`*^9, 3.6733427167912083`*^9}, {3.7529196342938643`*^9, 
  3.7529196377873077`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the curvature tensor:", "Subsubsection",
 CellChangeTimes->{3.6733491752874274`*^9}],

Cell[BoxData[
 RowBox[{"Curvature", ":=", 
  RowBox[{"Curvature", "=", "\[IndentingNewLine]", "                      ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "            ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"coord", "[", 
         RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "l", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"coord", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"affine", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "l", ",", "s"}], "]"}], "]"}], "*", 
          RowBox[{"affine", "[", 
           RowBox[{"[", 
            RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"affine", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "k", ",", "s"}], "]"}], "]"}], "*", 
          RowBox[{"affine", "[", 
           RowBox[{"[", 
            RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.673337118347827*^9, 3.673337224242091*^9}, {
   3.673337431372094*^9, 3.6733374494958954`*^9}, {3.673337563314971*^9, 
   3.6733376088165445`*^9}, {3.673337785528058*^9, 3.6733378810033865`*^9}, 
   3.6733379131457663`*^9, {3.6733379599479237`*^9, 3.673337983507249*^9}, {
   3.6733380760159225`*^9, 3.673338080047556*^9}, {3.6733381166157513`*^9, 
   3.673338125053856*^9}, {3.673338307539178*^9, 3.673338470317331*^9}, {
   3.6733385124157495`*^9, 3.673338608540371*^9}, {3.6733386385557375`*^9, 
   3.6733386984162264`*^9}, {3.673338866142559*^9, 3.6733388678069725`*^9}, {
   3.6733431811082935`*^9, 3.6733432000038776`*^9}, {3.6733491128966475`*^9, 
   3.6733491171296687`*^9}, {3.752963370175003*^9, 3.752963378225444*^9}, {
   3.752963735357276*^9, 3.752963751994027*^9}, {3.7529650692049847`*^9, 
   3.752965130969007*^9}, {3.752966892498262*^9, 3.752966897797854*^9}}],

Cell[BoxData[
 RowBox[{"Ricci", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Curvature", "[", 
       RowBox[{"s", ",", "i", ",", "s", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.752966878457672*^9, 3.752966887599297*^9}, {
  3.752966918332471*^9, 3.752967006249045*^9}}],

Cell[CellGroupData[{

Cell[BoxData["Ricci"], "Input",
 CellChangeTimes->{{3.75296701666856*^9, 3.75296701850319*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton",
             DisplayFunction->(FrameBox[
               
               RowBox[{
                "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
               Background -> GrayLevel[0.75], 
               BaseStyle -> {
                "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                 ShowStringCharacters -> False}, BaselinePosition -> Baseline,
                ContentPadding -> False, FrameMargins -> {{1, 1}, {1, 2}}, 
               FrameStyle -> None, RoundingRadius -> 7]& )], "}"}], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton",
             DisplayFunction->(FrameBox[
               
               RowBox[{
                "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
               Background -> GrayLevel[0.75], 
               BaseStyle -> {
                "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                 ShowStringCharacters -> False}, BaselinePosition -> Baseline,
                ContentPadding -> False, FrameMargins -> {{1, 1}, {1, 2}}, 
               FrameStyle -> None, RoundingRadius -> 7]& )], "}"}], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton",
             DisplayFunction->(FrameBox[
               
               RowBox[{
                "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
               Background -> GrayLevel[0.75], 
               BaseStyle -> {
                "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                 ShowStringCharacters -> False}, BaselinePosition -> Baseline,
                ContentPadding -> False, FrameMargins -> {{1, 1}, {1, 2}}, 
               FrameStyle -> None, RoundingRadius -> 7]& )], "}"}], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton",
             DisplayFunction->(FrameBox[
               
               RowBox[{
                "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
               Background -> GrayLevel[0.75], 
               BaseStyle -> {
                "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                 ShowStringCharacters -> False}, BaselinePosition -> Baseline,
                ContentPadding -> False, FrameMargins -> {{1, 1}, {1, 2}}, 
               FrameStyle -> None, RoundingRadius -> 7]& )], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{96., {3., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{90., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{90., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 129, 20337630308199629992, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{100., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{100., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 129, 20337630308199629992, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{72., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{72., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 129, 20337630308199629992, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{131., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{131., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[129]]], "Output",
 CellChangeTimes->{3.752967410877195*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Ricci", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.752967504706078*^9, 3.752967557985242*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Simplify","time",
   "\"Time spent on a transformation exceeded \
\\!\\(\\*RowBox[{\\\"300.`\\\"}]\\) seconds, and the transformation was \
aborted. Increasing the value of TimeConstraint option may improve the result \
of simplification.\"",2,131,3,20337630308199629992,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752968544992447*^9}],

Cell[BoxData[
 TemplateBox[{
  "Simplify","time",
   "\"Time spent on a transformation exceeded \
\\!\\(\\*RowBox[{\\\"300.`\\\"}]\\) seconds, and the transformation was \
aborted. Increasing the value of TimeConstraint option may improve the result \
of simplification.\"",2,131,4,20337630308199629992,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752968915430768*^9}],

Cell[BoxData[
 TemplateBox[{
  "Simplify","time",
   "\"Time spent on a transformation exceeded \
\\!\\(\\*RowBox[{\\\"300.`\\\"}]\\) seconds, and the transformation was \
aborted. Increasing the value of TimeConstraint option may improve the result \
of simplification.\"",2,131,5,20337630308199629992,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752969349232078*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Simplify\\\", \
\\\"::\\\", \\\"time\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,131,6,20337630308199629992,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752969349355834*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.75296754119142*^9, 3.7529711731622257`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1920, 1025},
WindowMargins->{{0, Automatic}, {Automatic, 1}},
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792},
"PostScriptOutputFile":>FrontEnd`FileName[{$RootDirectory, "home", "cosmic", 
   "hartle", "131book", "math"}, "wh.ps", CharacterEncoding -> "ISO8859-1"]},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 123, 1, 77, "Subtitle"],
Cell[706, 25, 382, 12, 50, "Text"],
Cell[1091, 39, 1605, 54, 216, "Text"],
Cell[2699, 95, 424, 10, 79, "Text"],
Cell[CellGroupData[{
Cell[3148, 109, 56, 0, 53, "Subsubsection"],
Cell[3207, 111, 205, 4, 45, "Text"],
Cell[3415, 117, 820, 13, 82, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4272, 135, 90, 1, 53, "Subsubsection"],
Cell[4365, 138, 129, 5, 45, "Text"],
Cell[CellGroupData[{
Cell[4519, 147, 49, 1, 48, "Input"],
Cell[4571, 150, 72, 1, 48, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4692, 157, 56, 0, 53, "Subsubsection"],
Cell[CellGroupData[{
Cell[4773, 161, 757, 17, 88, "Input"],
Cell[5533, 180, 137, 3, 48, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5719, 189, 113, 1, 53, "Subsubsection"],
Cell[5835, 192, 472, 9, 45, "Text"],
Cell[6310, 203, 3992, 123, 577, "Input"],
Cell[CellGroupData[{
Cell[10327, 330, 1418, 28, 48, "Input"],
Cell[11748, 360, 10832, 323, 490, "Output"]
}, Open  ]],
Cell[22595, 686, 125, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[22745, 691, 64, 1, 48, "Input"],
Cell[22812, 694, 11413, 328, 436, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34274, 1028, 56, 0, 53, "Subsubsection"],
Cell[34333, 1030, 181, 4, 48, "Input"],
Cell[34517, 1036, 72, 0, 45, "Text"],
Cell[34592, 1038, 109, 1, 43, "Item"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34738, 1044, 59, 0, 53, "Subsubsection"],
Cell[34800, 1046, 1798, 50, 148, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36635, 1101, 58, 0, 53, "Subsubsection"],
Cell[36696, 1103, 347, 7, 43, "Item"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37080, 1115, 102, 1, 53, "Subsubsection"],
Cell[37185, 1118, 2642, 59, 181, "Input"],
Cell[39830, 1179, 568, 15, 48, "Input"],
Cell[CellGroupData[{
Cell[40423, 1198, 95, 1, 48, "Input"],
Cell[40521, 1201, 9900, 246, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50458, 1452, 208, 5, 48, "Input"],
Cell[50669, 1459, 395, 8, 61, "Message"],
Cell[51067, 1469, 395, 8, 61, "Message"],
Cell[51465, 1479, 395, 8, 61, "Message"],
Cell[51863, 1489, 341, 7, 34, "Message"],
Cell[52207, 1498, 100, 1, 48, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

