(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23634,        573]
NotebookOptionsPosition[     22472,        548]
NotebookOutlinePosition[     22880,        565]
CellTagsIndexPosition[     22837,        562]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"coord", "=", 
  RowBox[{"{", 
   RowBox[{"time", ",", "x", ",", "y", ",", "z"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"R", "=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{"y", "^", "2"}], "+", 
     RowBox[{"z", "^", "2"}]}], ")"}], "0.5"]}], "\[IndentingNewLine]", 
 RowBox[{"rBL", " ", "=", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["R", "2"], "-", 
         SuperscriptBox["A", "2"]}], ")"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["R", "2"], "-", 
             SuperscriptBox["A", "2"]}], ")"}], "2"], "+", 
          RowBox[{"4", "*", 
           SuperscriptBox["A", "2"], "*", 
           SuperscriptBox["z", "2"]}]}], ")"}], "0.5"]}], ")"}], "/", "2"}], 
    ")"}], "0.5"]}], "\[IndentingNewLine]", 
 RowBox[{"Hks", " ", "=", 
  RowBox[{"M", "*", 
   RowBox[{"rBL", "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["rBL", "2"], "+", 
      RowBox[{
       SuperscriptBox["A", "2"], "*", 
       RowBox[{
        SuperscriptBox["z", "2"], "/", 
        SuperscriptBox["rBL", "2"]}]}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"l", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rBL", "*", "x"}], "+", 
       RowBox[{"A", "*", "y"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["rBL", "2"], "+", 
       SuperscriptBox["A", "2"]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rBL", "*", "y"}], "-", 
       RowBox[{"A", "*", "x"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["rBL", "2"], "+", 
       SuperscriptBox["A", "2"]}], ")"}]}], ",", 
    RowBox[{"z", "/", "rBL"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"gamma0", " ", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"gamma1", "=", 
  RowBox[{"-", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{"gamma2", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"Psi00", "=", 
  RowBox[{
   RowBox[{"-", "1.0"}], "+", 
   RowBox[{"2", "*", "Hks", "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Psi01", "=", 
  RowBox[{"2", "*", "Hks", "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}], "\n", 
 RowBox[{"Psi02", "=", 
  RowBox[{"2", "*", "Hks", "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Psi03", "=", 
   RowBox[{"2", "*", "Hks", "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Psi11", "=", 
  RowBox[{"1", "+", 
   RowBox[{"2", "*", "Hks", "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\n", 
 RowBox[{"Psi12", "=", 
  RowBox[{"2", "*", "Hks", "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}]}], "\n", 
 RowBox[{"Psi13", "=", 
  RowBox[{"2", "*", "Hks", "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Psi22", "=", 
  RowBox[{"1", "+", 
   RowBox[{"2", "*", "Hks", "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Psi23", "=", 
  RowBox[{"2", "*", "Hks", "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "*", 
   RowBox[{"l", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}], "\n", 
 RowBox[{"Psi33", "=", 
  RowBox[{"1", "+", 
   RowBox[{"2", "*", "Hks", "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "*", 
    RowBox[{"l", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"psi", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Psi00", ",", " ", "Psi01", ",", " ", "Psi02", ",", " ", "Psi03"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Psi01", ",", "Psi11", ",", "Psi12", ",", "Psi13"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"Psi02", ",", "Psi12", ",", "Psi22", ",", "Psi23"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"Psi03", ",", "Psi13", ",", "Psi23", ",", "Psi33"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"invPsi", "=", 
  RowBox[{"Inverse", "[", "psi", "]"}]}]}], "Input",
 CellChangeTimes->{{3.751270508471822*^9, 3.751270557858036*^9}, {
   3.75127074887319*^9, 3.751270807262402*^9}, {3.751270891797681*^9, 
   3.7512709015741673`*^9}, {3.7512709493640747`*^9, 3.751271027218719*^9}, {
   3.751271367088868*^9, 3.751271367254966*^9}, 3.751271540832222*^9, {
   3.751271947205471*^9, 3.751271955643066*^9}, {3.751271997744747*^9, 
   3.751272064272928*^9}, {3.7512722956737537`*^9, 3.7512722958458014`*^9}, 
   3.751276420310334*^9, 3.75132605795846*^9, {3.751519398450205*^9, 
   3.751519421703369*^9}, {3.751520983987472*^9, 3.751520988792054*^9}, {
   3.753001565142274*^9, 3.753001581268385*^9}, {3.753001763287834*^9, 
   3.753001776410495*^9}, 3.7530018150602913`*^9, {3.753002063912159*^9, 
   3.753002110614143*^9}, {3.753002144131576*^9, 3.7530021758035097`*^9}, {
   3.753002757761462*^9, 3.7530027581424*^9}, {3.753002977934209*^9, 
   3.753002986291629*^9}, {3.753003545747487*^9, 3.753003547840413*^9}, {
   3.753003592527155*^9, 3.75300359336077*^9}, {3.753003773806635*^9, 
   3.753003775547474*^9}, {3.7530051296070013`*^9, 3.753005135293634*^9}, {
   3.753163853076733*^9, 3.753163853205159*^9}, 3.753180588311902*^9, {
   3.7531812828484087`*^9, 3.753181284568981*^9}, {3.753421697315884*^9, 
   3.7534216975340853`*^9}, 3.756542931489567*^9, {3.756543211120414*^9, 
   3.756543262229147*^9}, {3.756543412628044*^9, 3.756543482619302*^9}, {
   3.756543536809325*^9, 3.756543557701078*^9}, {3.756543689215899*^9, 
   3.7565437683502607`*^9}, {3.756546283119906*^9, 3.756546343305768*^9}, {
   3.756546431692967*^9, 3.756546432792685*^9}, {3.756546489149063*^9, 
   3.756546584837018*^9}, {3.756546848609789*^9, 3.756547085525325*^9}, {
   3.7565474414991198`*^9, 3.756547495495919*^9}, {3.756547552586913*^9, 
   3.756547563119101*^9}, {3.7565481660480022`*^9, 3.756548177968321*^9}, 
   3.756548285874276*^9, {3.756560509904953*^9, 3.756560522183238*^9}, 
   3.756560583539918*^9, {3.7565613343942757`*^9, 3.756561338665597*^9}, 
   3.75656146687328*^9, {3.7577665000664988`*^9, 3.7577665543493958`*^9}, {
   3.757766590229447*^9, 3.757766616855893*^9}, {3.757806013593892*^9, 
   3.7578060373634157`*^9}, 3.757806124579433*^9, {3.7932730502970047`*^9, 
   3.793273053191703*^9}, {3.793273230779852*^9, 3.793273261152375*^9}, {
   3.793367141314702*^9, 3.793367143819171*^9}, {3.793524457029936*^9, 
   3.793524457999159*^9}, {3.7935245187098837`*^9, 3.793524573764135*^9}, {
   3.793524649816132*^9, 3.7935246556046352`*^9}, {3.8544244888110228`*^9, 
   3.854424703282729*^9}, {3.8544247765218143`*^9, 3.854424924428741*^9}, {
   3.854424968051875*^9, 3.854424971257086*^9}, {3.854425066497539*^9, 
   3.854425233777771*^9}, {3.8544252774981947`*^9, 3.854425292543437*^9}, {
   3.854425477308077*^9, 3.854425484591959*^9}, {3.8544257112501583`*^9, 
   3.854425733573082*^9}, {3.8544258550708237`*^9, 3.854425855489851*^9}, {
   3.854426486598817*^9, 3.854426536625184*^9}, {3.8544292445689173`*^9, 
   3.8544292474592533`*^9}, {3.854429722932168*^9, 3.854429723662236*^9}, {
   3.854437366783223*^9, 3.854437368132865*^9}, {3.854437507994094*^9, 
   3.854437538835566*^9}, {3.854438184694174*^9, 3.8544382187475557`*^9}, {
   3.8544429028159657`*^9, 3.854442925769552*^9}, {3.854443185430175*^9, 
   3.8544432021530333`*^9}, {3.854443318782689*^9, 3.854443353202155*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"87eb3d60-ef77-4d34-8dd2-f0846fafe331"],

Cell[BoxData[{
 RowBox[{"phi", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"psi", "[", 
        RowBox[{"[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}], ",", 
       RowBox[{"coord", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"psi", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"invG", "=", 
  RowBox[{"Inverse", "[", "g", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"lapse", "=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"psi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "*", 
        RowBox[{"psi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "*", 
        RowBox[{"invG", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "-", 
     RowBox[{"psi", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}], 
   "0.5"]}], "\[IndentingNewLine]", 
 RowBox[{"shift", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"psi", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "*", 
       RowBox[{"invG", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.751270744021452*^9, {3.751271036536317*^9, 3.751271112462411*^9}, {
   3.751271194891562*^9, 3.751271254390995*^9}, {3.751271373414802*^9, 
   3.7512713757868633`*^9}, 3.751271544335237*^9, {3.7512719150202827`*^9, 
   3.751271925559889*^9}, {3.751272055207706*^9, 3.751272187371972*^9}, {
   3.751272231113208*^9, 3.751272304999609*^9}, {3.751272651979917*^9, 
   3.751272653283718*^9}, {3.7512743064286127`*^9, 3.751274315681065*^9}, {
   3.7512743779226847`*^9, 3.751274438532243*^9}, {3.751275887081979*^9, 
   3.7512758890383673`*^9}, {3.751276058123241*^9, 3.7512760635096493`*^9}, {
   3.7512760950097*^9, 3.751276143570931*^9}, {3.7512761811298037`*^9, 
   3.7512762355104313`*^9}, {3.751276265658033*^9, 3.7512763119204817`*^9}, {
   3.751276361331368*^9, 3.751276410569269*^9}, {3.751276446554347*^9, 
   3.751276474149728*^9}, {3.7512782788395348`*^9, 3.75127835490405*^9}, {
   3.751278412330654*^9, 3.751278421568058*^9}, {3.751278457156198*^9, 
   3.751278461573413*^9}, {3.751278502891116*^9, 3.751278503026518*^9}, {
   3.751326064271799*^9, 3.751326069137121*^9}, {3.751519458958563*^9, 
   3.75151956304434*^9}, {3.751519598821507*^9, 3.7515197163568583`*^9}, {
   3.751520949705027*^9, 3.751520958658326*^9}, {3.7515210186861687`*^9, 
   3.751521021693646*^9}, {3.7516279649910183`*^9, 3.751628123259107*^9}, {
   3.751628153309485*^9, 3.751628190564416*^9}, {3.751753777652574*^9, 
   3.7517538130129128`*^9}, {3.751754154852084*^9, 3.751754162164909*^9}, {
   3.753001547615309*^9, 3.753001549060272*^9}, {3.7530018922827873`*^9, 
   3.753001911389091*^9}, {3.753001944532946*^9, 3.7530020063526154`*^9}, 
   3.753002195163671*^9, {3.753002237618937*^9, 3.7530022420665283`*^9}, {
   3.753002522324543*^9, 3.75300253175471*^9}, 3.753002690753076*^9, {
   3.753002729604574*^9, 3.753002745753549*^9}, {3.753002942328549*^9, 
   3.7530029464173822`*^9}, 3.753003046685986*^9, {3.753004017579969*^9, 
   3.7530040191473837`*^9}, {3.753005135367326*^9, 3.7530051360601*^9}, {
   3.756546602392383*^9, 3.756546605723721*^9}, 3.756547083075325*^9, {
   3.756560605076466*^9, 3.756560626320744*^9}, {3.7576774527006598`*^9, 
   3.757677461470042*^9}, {3.7577680645159693`*^9, 3.757768079535803*^9}, {
   3.757806051483191*^9, 3.757806056192194*^9}, {3.757806115706039*^9, 
   3.7578061197513037`*^9}, 3.854427451232176*^9, 3.854428128096641*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"6ab4ee58-3abd-4961-9ead-67e6e124dc45"],

Cell[BoxData[
 RowBox[{"tensorGamma", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"0.5", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"phi", "[", 
        RowBox[{"[", 
         RowBox[{"b", ",", "a", ",", "c"}], "]"}], "]"}], "+", 
       RowBox[{"phi", "[", 
        RowBox[{"[", 
         RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], "-", 
       RowBox[{"phi", "[", 
        RowBox[{"[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7512817277522287`*^9, 3.751281781148382*^9}, {
   3.751323878415268*^9, 3.751323995001506*^9}, 3.751325980731359*^9, 
   3.7513262926521807`*^9, 3.753001417464777*^9, 3.753005136289236*^9, 
   3.7576774634306498`*^9, 3.757768081156413*^9, 3.757806062315987*^9, 
   3.854428123600782*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"4773e41c-1963-4d94-a7f7-588371095ab4"],

Cell[BoxData[{
 RowBox[{"vecGamma", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"invPsi", "[", 
        RowBox[{"[", 
         RowBox[{"b", ",", "c"}], "]"}], "]"}], "*", 
       RowBox[{"tensorGamma", "[", 
        RowBox[{"[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", "4"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"H", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"vecGamma", "[", 
      RowBox[{"[", "a", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", "4"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"deriH", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"H", "[", 
       RowBox[{"[", "b", "]"}], "]"}], ",", 
      RowBox[{"coord", "[", 
       RowBox[{"[", "a", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.751279928401189*^9, 3.751280073886931*^9}, {
   3.751280157363744*^9, 3.751280167934905*^9}, {3.751280203417762*^9, 
   3.7512802692482986`*^9}, {3.7513255125434217`*^9, 
   3.7513255683336287`*^9}, {3.7513256014159393`*^9, 
   3.7513256246958933`*^9}, {3.751325982366255*^9, 3.7513260058697853`*^9}, {
   3.7513260371369667`*^9, 3.7513260384900293`*^9}, {3.751326180309223*^9, 
   3.751326244434863*^9}, {3.751519791493849*^9, 3.751519792765896*^9}, {
   3.751519882649179*^9, 3.7515200929735622`*^9}, {3.751627356529076*^9, 
   3.75162735747656*^9}, {3.7530014073441963`*^9, 3.753001439659169*^9}, 
   3.753005136421143*^9, 3.756548367894446*^9, 3.757677465544114*^9, 
   3.757768082884738*^9, 3.7578060685164423`*^9, {3.8544274585341063`*^9, 
   3.8544275013770237`*^9}, {3.854428114821212*^9, 3.85442812034086*^9}, 
   3.854431403800659*^9, 3.854455216475555*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"e0ffc08a-1633-4e3f-b89c-2b3d3966ae1b"],

Cell[BoxData[
 RowBox[{"t", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "/", "lapse"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"shift", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/", "lapse"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"shift", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "/", "lapse"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"shift", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "/", "lapse"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.751272655862199*^9, 3.751272693358968*^9}, {
   3.7512731838468*^9, 3.7512731931256943`*^9}, {3.751274169938673*^9, 
   3.7512742204975023`*^9}, {3.751274369113852*^9, 3.751274371935186*^9}, {
   3.7512744408938313`*^9, 3.7512744557837973`*^9}, {3.7512756892616463`*^9, 
   3.751275850081931*^9}, {3.751275881183689*^9, 3.7512758837201014`*^9}, {
   3.751275984566333*^9, 3.751276024243845*^9}, {3.751276517797613*^9, 
   3.751276518760714*^9}, {3.7512766512178698`*^9, 3.7512767224719343`*^9}, {
   3.7512767602542562`*^9, 3.751276761791065*^9}, {3.7512773327309093`*^9, 
   3.751277356942074*^9}, {3.7512783060492983`*^9, 3.751278307576022*^9}, 
   3.751278465039712*^9, 3.751278505145987*^9, {3.7517650388734617`*^9, 
   3.751765046632881*^9}, {3.7517673517377777`*^9, 3.751767446936908*^9}, {
   3.751767545916518*^9, 3.751767547222521*^9}, {3.751768797968248*^9, 
   3.75176880108049*^9}, 3.753001555273526*^9, 3.753001834087455*^9, {
   3.753001865042802*^9, 3.7530018694466763`*^9}, {3.753002271263804*^9, 
   3.753002275300664*^9}, {3.753002436668434*^9, 3.753002437287697*^9}, 
   3.7530027246799097`*^9, 3.753002819141409*^9, {3.7530051365384083`*^9, 
   3.7530051368326597`*^9}, {3.756270394879681*^9, 3.756270395924451*^9}, {
   3.756270440398426*^9, 3.756270450995123*^9}, 3.756277840056673*^9, {
   3.756547281527154*^9, 3.756547295776556*^9}, 3.7565492007398987`*^9, 
   3.756560643863172*^9, {3.757677473431156*^9, 3.757677474602539*^9}, {
   3.757768084399598*^9, 3.757768085888713*^9}, {3.7578060723429823`*^9, 
   3.757806089029619*^9}, 3.854449060403756*^9, {3.8544492733356867`*^9, 
   3.8544492786979303`*^9}, {3.854449333272649*^9, 3.854449337122119*^9}, 
   3.854450954763442*^9, 3.8544523736835403`*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"8439117b-e20e-4af0-9744-c8e79a645eea"],

Cell[BoxData[
 RowBox[{"pi", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "[", 
         RowBox[{"[", "c", "]"}], "]"}], "*", 
        RowBox[{"phi", "[", 
         RowBox[{"[", 
          RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.8544523779521427`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"3e45eb6c-198c-4866-ae22-692969a865c0"],

Cell[BoxData[
 RowBox[{"upperH", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"2", "Hks", "*", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", "rBL"}]}], ",", 
    RowBox[{
     RowBox[{"-", "2"}], "Hks", "*", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/", "rBL"}]}], ",", 
    RowBox[{
     RowBox[{"-", "2"}], "Hks", "*", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "/", "rBL"}]}], ",", 
    RowBox[{
     RowBox[{"-", "2"}], "Hks", "*", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "/", "rBL"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.854454749979144*^9, 3.854454764070212*^9}, {
   3.854454798058627*^9, 3.854454840835382*^9}, {3.854454873500147*^9, 
   3.8544549206057262`*^9}, {3.854454971792911*^9, 3.854455006109157*^9}, 
   3.8544550996765842`*^9, 3.854455718707334*^9, {3.8544557857512693`*^9, 
   3.854455825271269*^9}, {3.8544558968589077`*^9, 3.854455899884507*^9}, {
   3.854455976540759*^9, 3.854455983595887*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"2f145801-8b64-491b-a1a8-a59ab59a75ce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testH", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"upperH", "[", 
         RowBox[{"[", "s", "]"}], "]"}], "*", 
        RowBox[{"psi", "[", 
         RowBox[{"[", 
          RowBox[{"a", ",", "s"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.854455103981163*^9, 3.854455184485808*^9}, {
  3.854455253871019*^9, 3.854455304484054*^9}, {3.8544553360534067`*^9, 
  3.854455353037799*^9}, {3.854456098776288*^9, 3.854456103201233*^9}, {
  3.854456613466629*^9, 3.85445661452736*^9}, {3.854457017324435*^9, 
  3.854457017480359*^9}},ExpressionUUID->"f28c4864-8c0e-4a91-85c8-\
dae79e2e8353"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.85445700118252*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"b911aba4-ac7a-40b7-8e86-4d5b32bcf257"]
}, Open  ]]
},
WindowSize->{1440, 762},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.7,
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b2e32fb1-4300-4fba-9893-526d7827c5a0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8433, 203, 825, "Input",ExpressionUUID->"87eb3d60-ef77-4d34-8dd2-f0846fafe331"],
Cell[8994, 225, 4814, 108, 189, "Input",ExpressionUUID->"6ab4ee58-3abd-4961-9ead-67e6e124dc45"],
Cell[13811, 335, 1109, 27, 49, "Input",ExpressionUUID->"4773e41c-1963-4d94-a7f7-588371095ab4"],
Cell[14923, 364, 2261, 55, 120, "Input",ExpressionUUID->"e0ffc08a-1633-4e3f-b89c-2b3d3966ae1b"],
Cell[17187, 421, 2318, 41, 49, "Input",ExpressionUUID->"8439117b-e20e-4af0-9744-c8e79a645eea"],
Cell[19508, 464, 708, 20, 49, "Input",ExpressionUUID->"3e45eb6c-198c-4866-ae22-692969a865c0"],
Cell[20219, 486, 1158, 29, 49, "Input",ExpressionUUID->"2f145801-8b64-491b-a1a8-a59ab59a75ce"],
Cell[CellGroupData[{
Cell[21402, 519, 896, 22, 49, "Input",ExpressionUUID->"f28c4864-8c0e-4a91-85c8-dae79e2e8353"],
Cell[22301, 543, 155, 2, 56, "Output",ExpressionUUID->"b911aba4-ac7a-40b7-8e86-4d5b32bcf257"]
}, Open  ]]
}
]
*)

